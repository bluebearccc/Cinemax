<!DOCTYPE html>

<html xmlns:th="http://www.thymeleaf.org" lang="vi">



<head>

  <meta charset="UTF-8">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Food And Drink</title>

  <link rel="stylesheet" th:href="@{/staff/css/style.css}">

  <link rel="stylesheet" th:href="@{/staff/css/add_update_item.css}">
  <style>
    .alert {
      padding: 15px;
      margin-bottom: 20px;
      border: 1px solid transparent;
      border-radius: 4px;
      font-size: 16px;
      text-align: center;
    }

    /* Style ri√™ng cho th√¥ng b√°o l·ªói (m√†u ƒë·ªè) */
    .alert-error {
      color: #a94442; /* M√†u ch·ªØ ƒë·ªè s·∫´m */
      background-color: #f2dede; /* M√†u n·ªÅn h·ªìng nh·∫°t */
      border-color: #ebccd1; /* M√†u vi·ªÅn h·ªìng s·∫´m */
    }

    /* B·∫°n c≈©ng c√≥ th·ªÉ th√™m style cho th√¥ng b√°o th√†nh c√¥ng (m√†u xanh) n·∫øu c·∫ßn */
    .alert-success {
      color: #3c763d;
      background-color: #dff0d8;
      border-color: #d6e9c6;
    }
  </style>
</head>



<body>

<!-- Sidebar -->

<div class="sidebar">

  <div class="user-info">

    <div class="user-avatar" >M</div>

    <div class="user-name" >Mary Johnson</div>

  </div>



  <a href="#" class="sidebar-item">

    <div class="sidebar-icon">üè†</div>

    <div class="sidebar-text">Home</div>

  </a>

  <a th:href="@{/theater_stock}" class="sidebar-item ">

    <div class="sidebar-icon">üçø</div>

    <div class="sidebar-text">Food and Drinks</div>

  </a>

  <a th:href="@{/movie_schedule}" class="sidebar-item ">

    <div class="sidebar-icon">üìÖ</div>

    <div class="sidebar-text">Set Schedule</div>

  </a>

  <a th:href="@{/theater}" class="sidebar-item active">

    <div class="sidebar-icon">üé¨</div>

    <div class="sidebar-text">Manage Theater</div>

  </a>

</div>



<!-- Main Content -->

<div class="main-content">

  <!-- Header -->

  <div class="header">

    <div class="header-left">

      <div class="breadcrumb">

        <a href="#" th:href="@{/theater}">Manage Theater</a> >

        <span> Add new theater</span>

      </div>



    </div>

  </div>
  <div th:if="${message}" class="alert" th:classappend="${messageType == 'success'} ? 'alert-success' : 'alert-error'">
    <span th:text="${message}"></span>
  </div>
  <!-- Form Container -->
  <div class="form-container">
    <div class="form-header">
      <p class="form-subtitle">Complete the item information</p>
    </div>
    <form th:action="@{/theater/add_theater}"
          th:object="${theater}"
          method="post"
          enctype="multipart/form-data"
          id="stockForm"
          onsubmit="return validateForm()">
      <div class="form-row">
        <!-- Left Column - General Information -->
        <div class="form-column">

          <div class="form-group">

            <label class="form-label">Theater Name</label>
            <input type="text"
                   class="form-input"
                   th:field="*{theaterName}"
                   placeholder="Enter theater name begin with CGV"
                   required>
            <div class="error-message" id="nameError"></div>
          </div>

          <div class="form-column">

            <div class="form-group">

              <label class="form-label">Theater Address</label>
              <input type="text"
                     class="form-input"
                     th:field="*{address}"
                     placeholder="Enter theater address "
                     required>
              <div class="error-message" id="addressError"></div>
            </div>
          <!-- Status -->
          <div class="form-group">
            <label class="form-label">Set Availbility</label>
            <div class="radio-group">
              <div class="radio-item">
                <input type="radio"
                       id="statusActive"
                       name="status"
                       value="Active"
                       th:field="*{status}"
                       th:checked="${theater.status == 'Active'}"
                       checked
                >
                <label for="statusActive">Active</label>
              </div>
              <div class="radio-item">
                <input type="radio"
                       id="statusInactive"
                       name="status"
                       value="Inactive"
                       th:field="*{status}"
                       th:checked="${theater.status == 'Inactive'}">
                <label for="statusInactive">Inactive</label>
              </div>

            </div>
            <div class="error-message" id="statusError"></div>
          </div>
        </div>
        <!-- Right Column - Image Upload -->
        <div class="form-column">
          <!-- Image Upload -->
          <div class="form-group">
            <label class="form-label">Upload New Image</label>
            <div class="image-upload-area" onclick="document.getElementById('imageInput').click()">
              <div>üì∏</div>
              <p>Click to upload or drag and drop</p>
              <small>PNG, JPG, GIF up to 10MB</small>
            </div>
            <input type="file"
                   id="imageInput"
                   name="imageInput"
                   accept="image/*"
                   style="display: none;"
                   onchange="previewImage(this)">

            <div id="imagePreview" class="image-preview"></div>
            <div class="error-message" id="imageError"></div>
          </div>
        </div>
      </div>
      </div>
      <div class="form-actions">
        <button type="submit" class="btn btn-primary">Save</button>
        <button type="reset" class="btn btn-secondary" onclick="resetForm()">Reset</button>
        <a th:href="@{/theater}" class="btn btn-danger">Cancel</a>
      </div>
    </form>

  </div>

</div>

<script>
  // H√†m xem tr∆∞·ªõc ·∫£nh (gi·ªØ nguy√™n)
  function previewImage(input) {
    const preview = document.getElementById('imagePreview');
    preview.innerHTML = '';
    if (input.files && input.files[0]) {
      const file = input.files[0];
      if (!file.type.startsWith('image/')) {
        alert('Please upload an image file');
        input.value = '';
        return;
      }
      const reader = new FileReader();
      reader.onload = function(e) {
        const img = document.createElement('img');
        img.src = e.target.result;
        img.style.maxWidth = '100%';
        img.style.borderRadius = '8px';
        preview.appendChild(img);
      };
      reader.readAsDataURL(file);
    }
  }

  // H√†m reset form (gi·ªØ nguy√™n)
  function resetForm() {
    document.getElementById('stockForm').reset();
    document.getElementById('imagePreview').innerHTML = '';
    document.querySelectorAll('.error-message').forEach(el => el.textContent = '');
    document.getElementById('statusActive').checked = true;
  }

  // **** H√ÄM VALIDATE ƒê√É ƒê∆Ø·ª¢C VI·∫æT L·∫†I HO√ÄN TO√ÄN ****
  function validateForm() {
    let isValid = true;
    // X√≥a c√°c th√¥ng b√°o l·ªói c≈©
    document.querySelectorAll('.error-message').forEach(el => el.textContent = '');

    // 1. L·∫•y ƒë√∫ng c√°c tr∆∞·ªùng input t·ª´ form "Add Theater"
    const theaterNameInput = document.querySelector('input[name="theaterName"]');
    const addressInput = document.querySelector('input[name="address"]');
    const statusInput = document.querySelector('input[name="status"]:checked');
    const imageInput = document.getElementById('imageInput');

    // 2. Ki·ªÉm tra Theater Name
    if (theaterNameInput.value.trim() === '') {
      document.getElementById('nameError').textContent = 'Theater Name is required.';
      isValid = false;
    } else if (!theaterNameInput.value.trim().toLowerCase().startsWith('cgv')) {
      document.getElementById('nameError').textContent = 'Theater Name must begin with "CGV".';
      isValid = false;
    }

    // 3. Ki·ªÉm tra Address
    if (addressInput.value.trim() === '') {
      document.getElementById('addressError').textContent = 'Address is required.';
      isValid = false;
    }

    // 4. Ki·ªÉm tra Status
    if (!statusInput) {
      document.getElementById('statusError').textContent = 'Please select an availability status.';
      isValid = false;
    }

    // 5. Ki·ªÉm tra Image
    if (imageInput.files.length === 0) {
      document.getElementById('imageError').textContent = 'Please upload an image for the theater.';
      isValid = false;
    }

    return isValid;
  }
</script>
</body>
</html>