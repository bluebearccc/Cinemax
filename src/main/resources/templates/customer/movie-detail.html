<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <link rel="stylesheet" th:href="@{/customer-static/css/bootstrap.min.css}">
    <link rel="stylesheet" th:href="@{/customer-static/css/all.min.css}">
    <link rel="stylesheet" th:href="@{/customer-static/css/animate.css}">
    <link rel="stylesheet" th:href="@{/customer-static/css/flaticon.css}">
    <link rel="stylesheet" th:href="@{/customer-static/css/magnific-popup.css}">
    <link rel="stylesheet" th:href="@{/customer-static/css/odometer.css}">
    <link rel="stylesheet" th:href="@{/customer-static/css/owl.carousel.min.css}">
    <link rel="stylesheet" th:href="@{/customer-static/css/owl.theme.default.min.css}">
    <link rel="stylesheet" th:href="@{/customer-static/css/nice-select.css}">
    <link rel="stylesheet" th:href="@{/customer-static/css/main.css}">
    <link rel="stylesheet" th:href="@{/customer-static/css/common/footer-area.css}">
    <link rel="stylesheet" th:href="@{/customer-static/css/common/header-area.css}">
    <link rel="stylesheet" th:href="@{/customer-static/css/common/chatbot.css}">
    <link rel="stylesheet" th:href="@{/customer-static/css/movie-detail.css}">

    <link rel="shortcut icon" th:href="@{/customer-static/images/logo/logo.png}" type="image/x-icon">

    <title th:text="'Movie ' + ${movie.movieName}"></title>

<body>
<!-- ==========Preloader========== -->
<div th:replace="common/fragments/preloader :: preloader">
</div>
<!-- ==========Preloader========== -->
<!-- ==========Overlay========== -->
<a href="#0" class="scrollToTop">
    <i class="fas fa-angle-up"></i>
</a>
<!-- ==========Overlay========== -->
<!-- ==========Header-Section========== -->
<header th:replace="common/fragments/header :: header-section">
</header>
<!-- ==========Header-Section========== -->
<div class="floating-shapes">
    <div class="shape"></div>
    <div class="shape"></div>
    <div class="shape"></div>
    <div class="shape"></div>
    <div class="shape"></div>
    <div class="shape"></div>
    <div class="shape"></div>
    <div class="shape"></div>
</div>
<div class="hero-section" th:style="'background-image:url(' + @{${movie.banner}} + ');'">
    <input type="hidden" id="movieId" th:value="${movie.movieID}">
    <div th:if="${session.customer != null}">
        <input type="hidden" id="customerId" th:value="${session.customer.id}">
    </div>
    <div class="hero-content">
        <div class="movie-poster">
            <img class="poster-image" th:src="@{${movie.image}}">
            <div class="play-overlay" onclick="openTrailer()">
                <div class="play-icon"></div>
            </div>
            </img>
        </div>

        <div class="movie-info">
            <div class="age-rating" th:text="${movie.movieRate}"></div>
            <h1 class="movie-title" th:text="${movie.movieName}"></h1>

            <div class="movie-meta">
                <div class="meta-item">
                    <span class="meta-label">Genre</span>
                    <span class="meta-value" th:each="genre : ${movie.genres}" th:text="${genre.genreName}"></span>
                </div>
                <div class="meta-item">
                    <span class="meta-label">Duration</span>
                    <span class="meta-value" th:text="${movie.duration} + ' minutes'"></span>
                </div>
            </div>

            <p class="movie-description" th:text="${movie.description}">
            </p>

            <div class="action-buttons">
                <button class="btn btn-primary" onclick="openTrailer()">
                    <div class="play-icon"
                         style="border-left: 10px solid white; border-top: 6px solid transparent; border-bottom: 6px solid transparent; margin: 0; margin-right: 5px;">
                    </div>
                    Watch Trailer
                </button>
            </div>
        </div>
    </div>
</div>

<div class="main-content-detail">
    <div class="content-left">
        <div class="details-section">
            <h2 class="section-title">Showtimes</h2>
            <div id="book-detail-showtimes">
                <div class="showtimes" th:replace="customer/fragments/movie-detail/book-detail :: book-detail">
                </div>
            </div>
        </div>

        <!-- Cast Section -->
        <div class="cast-section">
            <h2 class="section-title">Cast & Studio</h2>
            <div class="carouselCast-container">
                <button class="nav-button prev prev-btn">‹</button>
                <button class="nav-button next next-btn">›</button>
                <div class="carouselCast">
                    <input type="hidden" id="number-of-actor" th:value="${movie.actors.size()}">
                    <div class="cast-card" th:each="actor : ${movie.actors}">
                        <img class="cast-avatar" th:src="@{${actor.image}}">
                        <div class="cast-name" th:text="${actor.actorName}"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Studio Section -->
        <div class="studio-info">
            <h3 class="section-title" style="margin-bottom: 20px; border: none; padding: 0;">Production Studio</h3>
            <div class="studio-name" th:text="${movie.studio}"></div>
        </div>

        <!-- Comments Section -->
        <div class="comments-section"
             th:replace="customer/fragments/movie-detail/feedback-detail :: feedback-detail">
        </div>
    </div>

    <!-- Sidebar -->
    <div class="sidebar">
        <h3 class="sidebar-title">Now Showing</h3>
        <div class="recommended-movie" th:each="recommnedMovie : ${top5movies.content}"
             th:onclick="|window.location.href='/customer/movie-detail?movieId=${recommnedMovie.movieID}'|">
            <div class="recommended-poster">
                <img class="img-poster" th:src="${recommnedMovie.image}">
            </div>
            <div class="recommended-info">
                <h4 th:text="${recommnedMovie.movieName}"></h4>
                <div class="recommended-rating">
                    <i class="fas fa-star"></i>
                    <span th:text="${recommnedMovie.movieRate}"></span>
                </div>
                <div class="recommended-rating" style="color: rgba(255,255,255,0.73)">
                    <i class="fas fa-clock"></i>
                    <span th:text="${recommnedMovie.duration} + ' minutes'"></span>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Trailer Modal -->
<div class="trailer-modal" id="trailerModal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 class="modal-title" th:text="'Trailer' + ${movie.movieName}"></h3>
            <button class="close-btn" onclick="closeTrailer()">&times;</button>
        </div>
        <div class="video-container">
            <iframe th:src="${movie.trailer} + '?modestbranding=1&rel=0&enablejsapi=0'" frameborder="0" allowfullscreen
                    width="100%;"
                    height="100%" id="trailerFrame" loading="lazy"></iframe>
        </div>
    </div>
</div>

<!-- ==========ChatBot-Section========== -->
<div class="chatbot-container" th:replace="common/fragments/chatbot :: chatbot"></div>
<!-- ==========ChatBot-Section========== -->
<!-- ==========Footer-Section========== -->
<footer class="footer-section" th:replace="common/fragments/footer :: footer">
</footer>
<!-- ==========Footer-Section========== -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script th:src="@{/customer-static/js/movie-detail.js}"></script>
<script th:src="@{/customer-static/js/chatbot.js}"></script>
<script th:src="@{/customer-static/js/jquery-3.3.1.min.js}"></script>
<script th:src="@{/customer-static/js/modernizr-3.6.0.min.js}"></script>
<script th:src="@{/customer-static/js/plugins.js}"></script>
<script th:src="@{/customer-static/js/bootstrap.min.js}"></script>
<script th:src="@{/customer-static/js/isotope.pkgd.min.js}"></script>
<script th:src="@{/customer-static/js/magnific-popup.min.js}"></script>
<script th:src="@{/customer-static/js/owl.carousel.min.js}"></script>
<script th:src="@{/customer-static/js/wow.min.js}"></script>
<script th:src="@{/customer-static/js/countdown.min.js}"></script>
<script th:src="@{/customer-static/js/odometer.min.js}"></script>
<script th:src="@{/customer-static/js/viewport.jquery.js}"></script>
<script th:src="@{/customer-static/js/main.js}"></script>
</body>

</html>